import pytest
from mahjong.efficiency import *


@pytest.mark.parametrize("test_input, expected", [
    ('58m23p189s234566z9p',
     [(4, [0, 8, 9, 27, 33], 20),
      (7, [0, 8, 9, 27, 33], 20),
      (10, [0, 8, 9, 27, 33], 20),
      (11, [0, 8, 9, 27, 33], 20),
      (25, [0, 8, 9, 27, 33], 20),
      ]),
    ('2569m348p3s122774z',
     [(27, [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 28, 30, 33], 87),
      (30, [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 27, 28, 33], 87),
      (8, [0, 1, 2, 3, 4, 5, 6, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 27, 28, 30, 33], 83),
      (1, [3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 27, 28, 30, 33], 79),
      (16, [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 18, 19, 20, 21, 22, 27, 28, 30, 33], 75),
      (20, [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 27, 28, 30, 33], 71),
      (4, [1, 5, 8, 11, 12, 16, 20, 27, 30], 27),
      (5, [1, 4, 8, 11, 12, 16, 20, 27, 30], 27),
      (11, [1, 4, 5, 8, 12, 16, 20, 27, 30], 27),
      (12, [1, 4, 5, 8, 11, 16, 20, 27, 30], 27),
      ]),
    ('19m19p159s1234567z',
     [(22, [0, 8, 9, 17, 18, 26, 27, 28, 29, 30, 31, 32, 33], 39),
      ]),
    ('69m5678p2789s344z7p',
     [(8, [3, 4, 5, 6, 7, 14, 17, 18, 19, 20, 21, 29, 30], 46),
      (29, [3, 4, 5, 6, 7, 8, 14, 17, 18, 19, 20, 21, 30], 46),
      (5, [6, 7, 8, 14, 17, 18, 19, 20, 21, 29, 30], 38),
      (19, [3, 4, 5, 6, 7, 8, 14, 17, 29, 30], 34),
      ]),
])
def test_calculate_efficiency(test_input, expected):
    efficiency = calculate_efficiency(Hand(test_input))
    assert efficiency == expected
